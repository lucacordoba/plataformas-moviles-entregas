<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Lista de Compras - DOM y JavaScript</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container my-4">
        <h1 class="mb-3">Lista de Compras</h1>
        <div class="card">
            <div class="card-body">

                <h2 class="h5">Listado de Productos</h2>
                <ul id="lista-productos" class="list-group mb-3">

                </ul>

                <div class="d-flex gap-2 mb-3">
                    <button id="btn-limpiar" class="btn btn-danger btn-sm">Limpiar lista</button>
                    <button id="btn-ordenar" class="btn btn-secondary btn-sm">Ordenar A-Z</button>
                </div>

                <h2 class="h5">Agregar Producto</h2>
                <form id="form-producto">
                    <div class="input-group">
                        <input type="text" class="form-control" placeholder="Nombre del Producto" required>
                        <button class="btn btn-primary" type="submit">Agregar</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

<script>
    const lista = document.getElementById('lista-productos');
    const form = document.getElementById('form-producto');
    const btnLimpiar = document.getElementById('btn-limpiar');
    const btnOrdenar = document.getElementById('btn-ordenar');

    function guardarLista() {
        const productos = [];
        lista.querySelectorAll("li").forEach(li => {
            productos.push({
                nombre: li.querySelector("span").textContent,
                comprado: li.classList.contains("comprado")
            });
        });
        localStorage.setItem("listaCompras", JSON.stringify(productos));
    }

    function cargarLista() {
        const guardados = JSON.parse(localStorage.getItem("listaCompras")) || [];
        guardados.forEach(p => agregarProducto(p.nombre, p.comprado));
    }

    function agregarProducto(nombre, comprado = false) {
        if (!nombre.trim()) return;

        const li = document.createElement("li");
        li.className = "list-group-item d-flex justify-content-between align-items-center";

        const span = document.createElement("span");
        span.textContent = nombre;

        span.addEventListener("click", () => {
            li.classList.toggle("comprado");
            guardarLista();
        });

        if (comprado) li.classList.add("comprado");

        const btnBorrar = document.createElement("button");
        btnBorrar.textContent = "x";
        btnBorrar.className = "btn btn-sm btn-outline-danger ms-2";
        btnBorrar.addEventListener("click", () => {
            li.remove();
            guardarLista();
        });

        li.appendChild(span);
        li.appendChild(btnBorrar);
        lista.appendChild(li);

        guardarLista();
    }

    form.addEventListener("submit", e => {
        e.preventDefault();
        const input = form.querySelector("input");
        agregarProducto(input.value);
        input.value = "";
    });

    btnLimpiar.addEventListener("click", () => {
        lista.innerHTML = "";
        guardarLista();
    });

    btnOrdenar.addEventListener("click", () => {
        const items = Array.from(lista.querySelectorAll("li"));
        items.sort((a, b) => 
            a.querySelector("span").textContent.localeCompare(b.querySelector("span").textContent)
        );
        lista.innerHTML = "";
        items.forEach(li => lista.appendChild(li));
        guardarLista();
    });

    const style = document.createElement("style");
    style.textContent = `.comprado span { text-decoration: line-through; color: gray; }`;
    document.head.appendChild(style);

    cargarLista();
</script>
</body>
</html>
